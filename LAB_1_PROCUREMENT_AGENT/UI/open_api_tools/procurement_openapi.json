{
  "openapi": "3.1.0",
  "info": {
    "title": "Retail Procurement API",
    "description": "Retail procurement management API for submitting and viewing purchase orders, tracking price changes, and managing staff approvals. Compatible with Watsonx Orchestrate and Swagger UI.",
    "version": "1.0.0"
  },
  "paths": {
    "/orders": {
      "get": {
        "summary": "View purchase order history",
        "description": "Retrieve the complete history of purchase orders, including product_name, supplier, price, quantity, purchase_date, staff_in_charge, approver, price_category, latest_price_change information.",
        "operationId": "getOrderHistory",
        "responses": {
          "200": {
            "description": "Returns a list of orders. Each order includes:\n- product_name: Name of the product\n- supplier: Supplier name\n- price: Price (float)\n- quantity: Quantity (int)\n- purchase_date: Date of purchase (YYYY-MM-DD)\n- staff_in_charge: Staff responsible\n- approver: Approver name\n- price_category: Price change category ('Avoidance', 'No Saving', 'Reduction')\n- latest_price_change: Price difference from previous order (string, '0' if not applicable)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrderHistoryResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new purchase order",
        "description": "Submit details to add a new purchase order, including product, supplier, quantity, and staff information. \n        Calculates price change compared to previous order for the same product.",
        "operationId": "addOrder",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/OrderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Returns the created order with a status message or an error message if some field are stil missing.\nFields returned:\n- message: Status message\n- product_name: Name of the product\n- supplier: Supplier name\n- price: Price (float)\n- quantity: Quantity (int)\n- purchase_date: Date of purchase (YYYY-MM-DD)\n- staff_in_charge: Staff responsible\n- approver: Approver name\n- price_category: Price change category ('Avoidance', 'No Saving', 'Reduction')\n- latest_price_change: Price difference from previous order (string, '0' if not applicable) Downstream logic should extract and present only the fields relevant to the userâ€™s query.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrderResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "OrderHistoryItem": {
        "properties": {
          "product_name": {
            "type": "string",
            "title": "Product Name"
          },
          "supplier": {
            "type": "string",
            "title": "Supplier"
          },
          "price": {
            "type": "number",
            "title": "Price"
          },
          "quantity": {
            "type": "integer",
            "title": "Quantity"
          },
          "purchase_date": {
            "type": "string",
            "title": "Purchase Date"
          },
          "staff_in_charge": {
            "type": "string",
            "title": "Staff In Charge"
          },
          "approver": {
            "type": "string",
            "title": "Approver"
          },
          "price_category": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Price Category",
            "default": "No Saving"
          },
          "latest_price_change": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latest Price Change",
            "default": "0"
          }
        },
        "type": "object",
        "required": [
          "product_name",
          "supplier",
          "price",
          "quantity",
          "purchase_date",
          "staff_in_charge",
          "approver"
        ],
        "title": "OrderHistoryItem"
      },
      "OrderHistoryResponse": {
        "properties": {
          "orders": {
            "items": {
              "$ref": "#/components/schemas/OrderHistoryItem"
            },
            "type": "array",
            "title": "Orders"
          }
        },
        "type": "object",
        "required": [
          "orders"
        ],
        "title": "OrderHistoryResponse"
      },
      "OrderRequest": {
        "properties": {
          "product_name": {
            "type": "string",
            "title": "Product Name"
          },
          "supplier": {
            "type": "string",
            "title": "Supplier"
          },
          "price": {
            "type": "number",
            "title": "Price"
          },
          "quantity": {
            "type": "integer",
            "title": "Quantity"
          },
          "purchase_date": {
            "type": "string",
            "title": "Purchase Date"
          },
          "staff_in_charge": {
            "type": "string",
            "title": "Staff In Charge"
          },
          "approver": {
            "type": "string",
            "title": "Approver"
          }
        },
        "type": "object",
        "required": [
          "product_name",
          "supplier",
          "price",
          "quantity",
          "purchase_date",
          "staff_in_charge",
          "approver"
        ],
        "title": "OrderRequest"
      },
      "OrderResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Status message for the order. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "product_name": {
            "type": "string",
            "title": "Product Name",
            "description": "Name of the product. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "supplier": {
            "type": "string",
            "title": "Supplier",
            "description": "Supplier name. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "price": {
            "type": "number",
            "title": "Price",
            "description": "Price of the product. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "quantity": {
            "type": "integer",
            "title": "Quantity",
            "description": "Quantity ordered. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "purchase_date": {
            "type": "string",
            "title": "Purchase Date",
            "description": "Date of purchase (YYYY-MM-DD). Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "staff_in_charge": {
            "type": "string",
            "title": "Staff In Charge",
            "description": "Staff responsible for the order. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "approver": {
            "type": "string",
            "title": "Approver",
            "description": "Name of the approver. Only extract and present from the user's query if relevant. Make sure it is not assumed N/A or None."
          },
          "price_category": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Price Category",
            "description": "Price change category: 'Avoidance' (price increased), 'No Saving' (price unchanged), 'Reduction' (price decreased).",
            "default": "No Saving"
          },
          "latest_price_change": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latest Price Change",
            "description": "Price difference from previous order (string, '0' if not applicable).",
            "default": "0"
          }
        },
        "type": "object",
        "required": [
          "message",
          "product_name",
          "supplier",
          "price",
          "quantity",
          "purchase_date",
          "staff_in_charge",
          "approver"
        ],
        "title": "OrderResponse"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    }
  },
  "servers": [
    {
      "url": "https://be-procurement-agent.1zy07nqib9k1.us-south.codeengine.appdomain.cloud",
      "description": "Production server"
    }
  ]
}
